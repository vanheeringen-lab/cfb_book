

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Introduction to pandas DataFrames &#8212; NWI-BM066A Computation for Biologists</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualization" href="10_visualization.html" />
    <link rel="prev" title="Functions and modules" href="functions_modules_style.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">NWI-BM066A Computation for Biologists</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="02_first_exercises.html">
   First exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_lists.html">
   Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_loops_control_flow.html">
   Control flow and loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Dictionaries
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dictionaries_exercises.html">
     Exercises: dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dictionaries_exercises.html#exercises-putting-it-all-together">
     Exercises: Putting it all together
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="files.html">
   Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions_modules_style.html">
   Functions and modules
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introduction to pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_visualization.html">
   Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_footprints.html">
   Creating a DNAseI footprint profile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_dnase_motifs.html">
   Motifs in DNase I peaks
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/09_pandas.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-the-pandas-module">
   Importing the pandas module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-pandas-dataframe-from-lists">
   Creating a pandas DataFrame from
   <code class="docutils literal notranslate">
    <span class="pre">
     lists
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-pandas-dataframe-using-a-dictionary">
   Creating a pandas DataFrame using a
   <code class="docutils literal notranslate">
    <span class="pre">
     dictionary
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-pandas-dataframes">
   Merging pandas DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-dataframes-on-column-values">
   Merging DataFrames on column values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-dataframes-concat">
   Merging DataFrames:
   <code class="docutils literal notranslate">
    <span class="pre">
     concat
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-dataframes-merge">
   Merging DataFrames:
   <code class="docutils literal notranslate">
    <span class="pre">
     merge
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tab-completion-and-help">
   Tab completion and help
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-a-dataframe">
   Sorting a DataFrame
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-to-obtain-dataframe-columns-or-rows">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     [
    </span>
    <span class="pre">
     ]
    </span>
   </code>
   to obtain DataFrame columns or rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-missing-values-or-nans">
   Removing missing values or
   <code class="docutils literal notranslate">
    <span class="pre">
     NaN
    </span>
   </code>
   s.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-calculations">
   Basic calculations
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-to-pandas-dataframes">
<h1>Introduction to pandas DataFrames<a class="headerlink" href="#introduction-to-pandas-dataframes" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial you are going to use the module <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.
We will focus on DataFrames, a convenient object type used in pandas.
This tutorial has no exercises, but serves as an introduction to pandas.
It will illustrate what you can do with pandas DataFrames.
If you want more information on pandas, a (quick) tutorial is found here:</p>
<p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/10min.html">http://pandas.pydata.org/pandas-docs/stable/10min.html</a></p>
<div class="section" id="importing-the-pandas-module">
<h2>Importing the pandas module<a class="headerlink" href="#importing-the-pandas-module" title="Permalink to this headline">¶</a></h2>
<p>We start by importing the pandas module, for which we use the following command:</p>
<p>Note that we imported the pandas module and renamed it to <code class="docutils literal notranslate"><span class="pre">pd</span></code>.
This allows us to call all pandas commands using <code class="docutils literal notranslate"><span class="pre">pd</span></code> (instead of <code class="docutils literal notranslate"><span class="pre">pandas</span></code>).
This is very common: it saves typing since <code class="docutils literal notranslate"><span class="pre">pd</span></code> is shorter than <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
</div>
<div class="section" id="creating-a-pandas-dataframe-from-lists">
<h2>Creating a pandas DataFrame from <code class="docutils literal notranslate"><span class="pre">lists</span></code><a class="headerlink" href="#creating-a-pandas-dataframe-from-lists" title="Permalink to this headline">¶</a></h2>
<p>Here we will create a pandas DataFrame containing the following columns:</p>
<p>In this case we create an empty DataFrame first, and we fill it up with the individual columns</p>
<p>You can check what your DataFrame looks like using  <code class="docutils literal notranslate"><span class="pre">print()</span></code>, or simply type <code class="docutils literal notranslate"><span class="pre">df_peaks_exp1</span></code>.</p>
<p>We make a second DataFrame, which corresponds to a second experiment (‘exp2’)</p>
<p>Look at both DataFrames.</p>
<p>They have the same column layout (chr, start, end, refseq).</p>
<p>They both represent peaks of a ChIP-seq experiment.</p>
<p>For both DataFrames we can add an additional column indicating from which experiment the data comes (‘exp1’ or ‘exp2’)</p>
<p>Take a look at the two DataFrames, and note how we did this:</p>
<ul class="simple">
<li><p>We used <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> to define a new colum, with the column name between <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code></p></li>
<li><p>We only used only one string (‘exp1’), but this was automatically expanded to the whole column</p></li>
</ul>
</div>
<div class="section" id="creating-a-pandas-dataframe-using-a-dictionary">
<h2>Creating a pandas DataFrame using a <code class="docutils literal notranslate"><span class="pre">dictionary</span></code><a class="headerlink" href="#creating-a-pandas-dataframe-using-a-dictionary" title="Permalink to this headline">¶</a></h2>
<p>We can also create a pandas DataFrame from a dictionary. The dictionary should contain <strong>column names as keys</strong> and <strong>lists as values</strong> for the columns. To show this in action, we will use the three following lists:</p>
<p>First, we use these lists to create a dictionary</p>
<p>Now that we have the dictionary, we can create the DataFrame.</p>
<p>Look at the resulting DataFrame called <code class="docutils literal notranslate"><span class="pre">df_genes</span></code>. This DataFrame will help us to map RefSeq to ENSEMBL gene identifiers.</p>
<p>Next, we create another DataFrame with gene expression values</p>
<p>Again, we will use a dictionary for this.</p>
</div>
<div class="section" id="merging-pandas-dataframes">
<h2>Merging pandas DataFrames<a class="headerlink" href="#merging-pandas-dataframes" title="Permalink to this headline">¶</a></h2>
<p>Look at the DataFrames using print (or by just typing the DataFrame name followed by Enter)</p>
<p>In case we would have very long DataFrames, can use <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> (where <code class="docutils literal notranslate"><span class="pre">df</span></code> is your DataFrame name)</p>
</div>
<div class="section" id="merging-dataframes-on-column-values">
<h2>Merging DataFrames on column values<a class="headerlink" href="#merging-dataframes-on-column-values" title="Permalink to this headline">¶</a></h2>
<p>We now have 3 types of data in our 3 DataFrames:</p>
<ul class="simple">
<li><p>ChIP-seq peaks (<code class="docutils literal notranslate"><span class="pre">df_peaks</span></code>)</p></li>
<li><p>A RefSeq to ENSEMBL gene identifier mapping (<code class="docutils literal notranslate"><span class="pre">df_genes</span></code>)</p></li>
<li><p>Expression values of genes in 4 samples, with ENSEMBL identifiers (<code class="docutils literal notranslate"><span class="pre">df_expr</span></code>)</p></li>
</ul>
<p>This is a typical example for any (bioinformatical) analysis in which you want to incorporate different data types, often from different sources. You need to merge them if you want to do anything useful. Pandas DataFrames can be of big help here.</p>
<p>So let us try to merge these pieces of data</p>
</div>
<div class="section" id="merging-dataframes-concat">
<h2>Merging DataFrames: <code class="docutils literal notranslate"><span class="pre">concat</span></code><a class="headerlink" href="#merging-dataframes-concat" title="Permalink to this headline">¶</a></h2>
<p>Using the command <code class="docutils literal notranslate"><span class="pre">concat</span></code> we can concatenate multiple DataFrames.
Let us do this with the 2 ChIP-seq peaks DataFrames:</p>
<p>Check out the result, and note how the <code class="docutils literal notranslate"><span class="pre">exp</span></code> column still allows us to distinghuish the two experiments.</p>
<p>Next, we merge the ChIP-seq peaks with the gene identifier mappings, using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function</p>
</div>
<div class="section" id="merging-dataframes-merge">
<h2>Merging DataFrames: <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#merging-dataframes-merge" title="Permalink to this headline">¶</a></h2>
<p>Here we will merge the three different DataFrames (<code class="docutils literal notranslate"><span class="pre">df_peaks</span></code>, <code class="docutils literal notranslate"><span class="pre">df_genes</span></code>, <code class="docutils literal notranslate"><span class="pre">df_expr</span></code>) using the gene identifiers. Note that we have two different gene identifiers (RefSeq and ENSEMBL).</p>
<p>First, we merge <code class="docutils literal notranslate"><span class="pre">df_peaks</span></code> with <code class="docutils literal notranslate"><span class="pre">df_genes</span></code>.</p>
<p>Check the resulting DataFrame.
Our DataFrame now has the ENSEMBL gene identifiers, so we can also merge the <code class="docutils literal notranslate"><span class="pre">df_expr</span></code>.</p>
<p>For convenience, we will use a shorter name for our merged DataFrame</p>
</div>
<div class="section" id="tab-completion-and-help">
<h2>Tab completion and help<a class="headerlink" href="#tab-completion-and-help" title="Permalink to this headline">¶</a></h2>
<p>Now that we have merged our data, we can do several neat things.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">df_all</span></code> is a pandas DataFrame, it automatically inherits DataFrame methods.</p>
<p>You can get an idea if you type:</p>
<p>Now hit the left &lt;Tab&gt; key</p>
<p>Notice that you get a lot of options….</p>
<p>Suppose you want to know how the <code class="docutils literal notranslate"><span class="pre">sort_values()</span></code> method for a DataFrame works. You can type:</p>
<p>This HELP menu gives you information about the function. type ‘q’ or &lt;ESC&gt; to leave the HELP</p>
</div>
<div class="section" id="sorting-a-dataframe">
<h2>Sorting a DataFrame<a class="headerlink" href="#sorting-a-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Let us try it out:</p>
<p>or</p>
<p>Note that these commands did not replace the original DataFrame <code class="docutils literal notranslate"><span class="pre">df_all</span></code>!</p>
</div>
<div class="section" id="using-to-obtain-dataframe-columns-or-rows">
<h2>Using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> to obtain DataFrame columns or rows<a class="headerlink" href="#using-to-obtain-dataframe-columns-or-rows" title="Permalink to this headline">¶</a></h2>
<p>Using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> we can obtain specific parts of the DataFrame.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">iloc</span></code> we can do the same using indexes</p>
<p>One index by default points to <strong>rows</strong> of a DataFrame</p>
<p>To get the 2nd row, type:</p>
<p>Or, for multiple rows:</p>
<p>This works very much like indexes of a <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
<p>If you use two indices, you can obtain specific rows <strong>and</strong> columns.</p>
<p>The first index is always <strong>rows</strong>, the second <strong>columns</strong>.</p>
</div>
<div class="section" id="removing-missing-values-or-nans">
<h2>Removing missing values or <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s.<a class="headerlink" href="#removing-missing-values-or-nans" title="Permalink to this headline">¶</a></h2>
<p>In many cases DataFrames contains <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, missing values, and you often have to remove them.</p>
<p>We have several such <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s in <code class="docutils literal notranslate"><span class="pre">df_all</span></code>.</p>
<p>We can obtain a <code class="docutils literal notranslate"><span class="pre">boolean</span></code> (True/False) for the column called ‘sample1’ like this:</p>
<p>By using the <code class="docutils literal notranslate"><span class="pre">~</span></code> symbol we can invert this <code class="docutils literal notranslate"><span class="pre">boolean</span></code> column. The <code class="docutils literal notranslate"><span class="pre">~</span></code> acts as <code class="docutils literal notranslate"><span class="pre">not</span></code> for a pandas Series.</p>
<p>We can use this strategy to remove all rows that have <code class="docutils literal notranslate"><span class="pre">NaN</span></code> in the column <code class="docutils literal notranslate"><span class="pre">sample1</span></code>:</p>
<p>Make sure you understand how this worked!</p>
<p>We can do the same for getting all rows corresponding to <code class="docutils literal notranslate"><span class="pre">exp1</span></code> (experiment 1):</p>
</div>
<div class="section" id="basic-calculations">
<h2>Basic calculations<a class="headerlink" href="#basic-calculations" title="Permalink to this headline">¶</a></h2>
<p>There are a lot of methods that allows you to do basic calculation on DataFrames.</p>
<p>As an illustration we will calculate the pairwise correlations between the columns <code class="docutils literal notranslate"><span class="pre">sample1</span></code>, <code class="docutils literal notranslate"><span class="pre">sample2</span></code>, <code class="docutils literal notranslate"><span class="pre">sample3</span></code>, and <code class="docutils literal notranslate"><span class="pre">sample4</span></code>.</p>
<p>We take the appropriate columns first</p>
<p>Now we can use the pandas <code class="docutils literal notranslate"><span class="pre">corr</span></code> method to calculate all pairwise correlations:</p>
<p>Ooops, this did not work. It turns out that the numbers inside our DataFrame are not actually of the appropriate ‘type’. We need to convert them to <code class="docutils literal notranslate"><span class="pre">float</span></code>:</p>
<p>Now we can calculate the correlations:</p>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="functions_modules_style.html" title="previous page">Functions and modules</a>
    <a class='right-next' id="next-link" href="10_visualization.html" title="next page">Visualization</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Simon van Heeringen, Arjen Brinkman, Kees Albers<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>