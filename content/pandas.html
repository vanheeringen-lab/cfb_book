

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Introduction to pandas DataFrames &#8212; NWI-BM066A Computation for Biologists</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualization" href="visualization.html" />
    <link rel="prev" title="Functions and modules" href="functions_modules_style.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">NWI-BM066A Computation for Biologists</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="first_exercises.html">
   First exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lists.html">
   Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="control_flow.html">
   Control flow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="loops.html">
   Loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Dictionaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="files.html">
   Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="files.html#exercises-putting-it-all-together">
   Exercises: putting it all together
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scripts_and_debugging.html">
   Scripts and debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions_modules_style.html">
   Functions and modules
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introduction to pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visualization.html">
   Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="footprints.html">
   Creating a DNAseI footprint profile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dnase_motifs.html">
   Motifs in DNase I peaks
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/pandas.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#importing-the-pandas-module">
   Importing the pandas module
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-pandas-dataframe-from-lists">
   Creating a pandas DataFrame from lists
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-pandas-dataframe-using-a-dictionary">
   Creating a pandas DataFrame using a
   <code class="docutils literal notranslate">
    <span class="pre">
     dictionary
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-pandas-dataframes">
   Merging pandas DataFrames
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-dataframes-on-column-values">
   Merging DataFrames on column values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-dataframes-concat">
   Merging DataFrames:
   <code class="docutils literal notranslate">
    <span class="pre">
     concat
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-dataframes-merge">
   Merging DataFrames:
   <code class="docutils literal notranslate">
    <span class="pre">
     merge
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tab-completion-and-help">
   Tab completion and help
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-a-dataframe">
   Sorting a DataFrame
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-to-obtain-dataframe-columns-or-rows">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     [
    </span>
    <span class="pre">
     ]
    </span>
   </code>
   to obtain DataFrame columns or rows
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#removing-missing-values-or-nans">
   Removing missing values or
   <code class="docutils literal notranslate">
    <span class="pre">
     NaN
    </span>
   </code>
   s.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-calculations">
   Basic calculations
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-to-pandas-dataframes">
<h1>Introduction to pandas DataFrames<a class="headerlink" href="#introduction-to-pandas-dataframes" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial you are going to use the module <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.
We will focus on DataFrames, a convenient object type used in pandas.
This tutorial has no exercises, but serves as an introduction to pandas.
It will illustrate what you can do with pandas DataFrames.
If you want more information on pandas, a (quick) tutorial is found here:</p>
<p><a class="reference external" href="http://pandas.pydata.org/pandas-docs/stable/10min.html">http://pandas.pydata.org/pandas-docs/stable/10min.html</a></p>
<div class="section" id="importing-the-pandas-module">
<h2>Importing the pandas module<a class="headerlink" href="#importing-the-pandas-module" title="Permalink to this headline">¶</a></h2>
<p>We start by importing the pandas module, for which we use the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Note that we imported the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> module and renamed it to <code class="docutils literal notranslate"><span class="pre">pd</span></code>. This allows us to use all <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functionality using <code class="docutils literal notranslate"><span class="pre">pd</span></code> (instead of <code class="docutils literal notranslate"><span class="pre">pandas</span></code>). This is very common: it saves typing since <code class="docutils literal notranslate"><span class="pre">pd</span></code> is shorter than <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
</div>
<div class="section" id="creating-a-pandas-dataframe-from-lists">
<h2>Creating a pandas DataFrame from lists<a class="headerlink" href="#creating-a-pandas-dataframe-from-lists" title="Permalink to this headline">¶</a></h2>
<p>Here we will create a pandas DataFrame containing the following columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chr_exp1</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;chr1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;chr11&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;chr11&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;chr11&quot;</span><span class="p">,</span> <span class="s2">&quot;chr13&quot;</span><span class="p">,</span> <span class="s2">&quot;chr15&quot;</span><span class="p">,</span> <span class="s2">&quot;chr17&quot;</span><span class="p">,</span> <span class="s2">&quot;chr17&quot;</span><span class="p">,</span> <span class="s2">&quot;chr19&quot;</span><span class="p">,</span> <span class="s2">&quot;chr19&quot;</span><span class="p">,</span> <span class="s2">&quot;chr2&quot;</span><span class="p">,</span> <span class="s2">&quot;chr2&quot;</span><span class="p">,</span> <span class="s2">&quot;chr3&quot;</span><span class="p">,</span> <span class="s2">&quot;chr4&quot;</span><span class="p">,</span> <span class="s2">&quot;chr4&quot;</span><span class="p">,</span> <span class="s2">&quot;chr4&quot;</span><span class="p">,</span> <span class="s2">&quot;chr5&quot;</span><span class="p">,</span> <span class="s2">&quot;chr5&quot;</span><span class="p">,</span> <span class="s2">&quot;chr6&quot;</span><span class="p">,</span> <span class="s2">&quot;chr6&quot;</span><span class="p">]</span>

<span class="n">start_exp1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">43232415</span><span class="p">,</span> <span class="mi">74459412</span><span class="p">,</span> <span class="mi">77774406</span><span class="p">,</span> <span class="mi">131780211</span><span class="p">,</span> <span class="mi">20806034</span><span class="p">,</span> <span class="mi">66795152</span><span class="p">,</span> <span class="mi">7590368</span><span class="p">,</span> <span class="mi">26903451</span><span class="p">,</span> <span class="mi">36705003</span><span class="p">,</span> <span class="mi">53761044</span><span class="p">,</span> <span class="mi">74880854</span><span class="p">,</span> <span class="mi">203102822</span><span class="p">,</span> <span class="mi">14988512</span><span class="p">,</span> <span class="mi">4543357</span><span class="p">,</span> <span class="mi">16077241</span><span class="p">,</span> <span class="mi">20851791</span><span class="p">,</span> <span class="mi">130970429</span><span class="p">,</span> <span class="mi">131563056</span><span class="p">,</span> <span class="mi">111888063</span><span class="p">,</span> <span class="mi">143889976</span><span class="p">]</span>

<span class="n">end_exp1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">43233415</span><span class="p">,</span> <span class="mi">74460412</span><span class="p">,</span> <span class="mi">77775406</span><span class="p">,</span> <span class="mi">131781211</span><span class="p">,</span> <span class="mi">20807034</span><span class="p">,</span> <span class="mi">66796152</span><span class="p">,</span> <span class="mi">7591368</span><span class="p">,</span> <span class="mi">26904451</span><span class="p">,</span> <span class="mi">36706003</span><span class="p">,</span> <span class="mi">53762044</span><span class="p">,</span> <span class="mi">74881854</span><span class="p">,</span> <span class="mi">203103822</span><span class="p">,</span> <span class="mi">14989512</span><span class="p">,</span> <span class="mi">4544357</span><span class="p">,</span> <span class="mi">16078241</span><span class="p">,</span> <span class="mi">20852791</span><span class="p">,</span> <span class="mi">130971429</span><span class="p">,</span> <span class="mi">131564056</span><span class="p">,</span> <span class="mi">111889063</span><span class="p">,</span> <span class="mi">143890976</span><span class="p">]</span>

<span class="n">refseq_exp1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NM_024097&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001098638&quot;</span><span class="p">,</span><span class="s2">&quot;NM_003251&quot;</span><span class="p">,</span><span class="s2">&quot;NM_016522&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001110221&quot;</span><span class="p">,</span><span class="s2">&quot;NR_002441&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001126112&quot;</span><span class="p">,</span><span class="s2">&quot;NM_005165&quot;</span><span class="p">,</span><span class="s2">&quot;NM_007145&quot;</span><span class="p">,</span><span class="s2">&quot;NM_173856&quot;</span><span class="p">,</span><span class="s2">&quot;NM_004263&quot;</span><span class="p">,</span><span class="s2">&quot;NM_003352&quot;</span><span class="p">,</span><span class="s2">&quot;NR_046253&quot;</span><span class="p">,</span><span class="s2">&quot;NR_037888&quot;</span><span class="p">,</span><span class="s2">&quot;NM_006017&quot;</span><span class="p">,</span><span class="s2">&quot;NM_147181&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001164386&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001142599&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001164283&quot;</span><span class="p">,</span><span class="s2">&quot;NR_027113&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>In this case we create an empty DataFrame first, and we fill it up with the individual columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_peaks_exp1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">df_peaks_exp1</span><span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chr_exp1</span>
<span class="n">df_peaks_exp1</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_exp1</span>
<span class="n">df_peaks_exp1</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_exp1</span>
<span class="n">df_peaks_exp1</span><span class="p">[</span><span class="s1">&#39;refseq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">refseq_exp1</span>
</pre></div>
</div>
</div>
</div>
<p>You can check what your DataFrame looks like using  <code class="docutils literal notranslate"><span class="pre">print()</span></code>, or simply type <code class="docutils literal notranslate"><span class="pre">df_peaks_exp1</span></code>. The latter only works in a Jupyter notebook, but the advantage is that you get a nicely formatted table!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_peaks_exp1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>      chr      start        end        refseq
0    chr1   43232415   43233415     NM_024097
1   chr11   74459412   74460412  NM_001098638
2   chr11   77774406   77775406     NM_003251
3   chr11  131780211  131781211     NM_016522
4   chr13   20806034   20807034  NM_001110221
5   chr15   66795152   66796152     NR_002441
6   chr17    7590368    7591368  NM_001126112
7   chr17   26903451   26904451     NM_005165
8   chr19   36705003   36706003     NM_007145
9   chr19   53761044   53762044     NM_173856
10   chr2   74880854   74881854     NM_004263
11   chr2  203102822  203103822     NM_003352
12   chr3   14988512   14989512     NR_046253
13   chr4    4543357    4544357     NR_037888
14   chr4   16077241   16078241     NM_006017
15   chr4   20851791   20852791     NM_147181
16   chr5  130970429  130971429  NM_001164386
17   chr5  131563056  131564056  NM_001142599
18   chr6  111888063  111889063  NM_001164283
19   chr6  143889976  143890976     NR_027113
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_peaks_exp1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>refseq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chr1</td>
      <td>43232415</td>
      <td>43233415</td>
      <td>NM_024097</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chr11</td>
      <td>74459412</td>
      <td>74460412</td>
      <td>NM_001098638</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chr11</td>
      <td>77774406</td>
      <td>77775406</td>
      <td>NM_003251</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chr11</td>
      <td>131780211</td>
      <td>131781211</td>
      <td>NM_016522</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chr13</td>
      <td>20806034</td>
      <td>20807034</td>
      <td>NM_001110221</td>
    </tr>
    <tr>
      <th>5</th>
      <td>chr15</td>
      <td>66795152</td>
      <td>66796152</td>
      <td>NR_002441</td>
    </tr>
    <tr>
      <th>6</th>
      <td>chr17</td>
      <td>7590368</td>
      <td>7591368</td>
      <td>NM_001126112</td>
    </tr>
    <tr>
      <th>7</th>
      <td>chr17</td>
      <td>26903451</td>
      <td>26904451</td>
      <td>NM_005165</td>
    </tr>
    <tr>
      <th>8</th>
      <td>chr19</td>
      <td>36705003</td>
      <td>36706003</td>
      <td>NM_007145</td>
    </tr>
    <tr>
      <th>9</th>
      <td>chr19</td>
      <td>53761044</td>
      <td>53762044</td>
      <td>NM_173856</td>
    </tr>
    <tr>
      <th>10</th>
      <td>chr2</td>
      <td>74880854</td>
      <td>74881854</td>
      <td>NM_004263</td>
    </tr>
    <tr>
      <th>11</th>
      <td>chr2</td>
      <td>203102822</td>
      <td>203103822</td>
      <td>NM_003352</td>
    </tr>
    <tr>
      <th>12</th>
      <td>chr3</td>
      <td>14988512</td>
      <td>14989512</td>
      <td>NR_046253</td>
    </tr>
    <tr>
      <th>13</th>
      <td>chr4</td>
      <td>4543357</td>
      <td>4544357</td>
      <td>NR_037888</td>
    </tr>
    <tr>
      <th>14</th>
      <td>chr4</td>
      <td>16077241</td>
      <td>16078241</td>
      <td>NM_006017</td>
    </tr>
    <tr>
      <th>15</th>
      <td>chr4</td>
      <td>20851791</td>
      <td>20852791</td>
      <td>NM_147181</td>
    </tr>
    <tr>
      <th>16</th>
      <td>chr5</td>
      <td>130970429</td>
      <td>130971429</td>
      <td>NM_001164386</td>
    </tr>
    <tr>
      <th>17</th>
      <td>chr5</td>
      <td>131563056</td>
      <td>131564056</td>
      <td>NM_001142599</td>
    </tr>
    <tr>
      <th>18</th>
      <td>chr6</td>
      <td>111888063</td>
      <td>111889063</td>
      <td>NM_001164283</td>
    </tr>
    <tr>
      <th>19</th>
      <td>chr6</td>
      <td>143889976</td>
      <td>143890976</td>
      <td>NR_027113</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We make a second DataFrame, which corresponds to a second experiment (‘exp2’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chr_exp2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;chr6_dbb_hap3&quot;</span><span class="p">,</span> <span class="s2">&quot;chr6_mann_hap4&quot;</span><span class="p">,</span> <span class="s2">&quot;chr6_qbl_hap6&quot;</span><span class="p">,</span> <span class="s2">&quot;chr6_qbl_hap6&quot;</span><span class="p">,</span> <span class="s2">&quot;chr6_ssto_hap7&quot;</span><span class="p">,</span> <span class="s2">&quot;chr7&quot;</span><span class="p">,</span> <span class="s2">&quot;chr9&quot;</span><span class="p">,</span> <span class="s2">&quot;chrX&quot;</span><span class="p">,</span> <span class="s2">&quot;chrX&quot;</span><span class="p">,</span> <span class="s2">&quot;chrX&quot;</span><span class="p">]</span>
<span class="n">start_exp2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4324541</span><span class="p">,</span> <span class="mi">1932656</span><span class="p">,</span> <span class="mi">3218006</span><span class="p">,</span> <span class="mi">4038208</span><span class="p">,</span> <span class="mi">3038042</span><span class="p">,</span> <span class="mi">98029927</span><span class="p">,</span> <span class="mi">90497271</span><span class="p">,</span> <span class="mi">71496641</span><span class="p">,</span> <span class="mi">73506544</span><span class="p">,</span> <span class="mi">152162171</span><span class="p">]</span>
<span class="n">end_exp2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4325541</span><span class="p">,</span> <span class="mi">1933656</span><span class="p">,</span> <span class="mi">3219006</span><span class="p">,</span> <span class="mi">4039208</span><span class="p">,</span> <span class="mi">3039042</span><span class="p">,</span> <span class="mi">98030927</span><span class="p">,</span> <span class="mi">90498271</span><span class="p">,</span> <span class="mi">71497641</span><span class="p">,</span> <span class="mi">73507544</span><span class="p">,</span> <span class="mi">152163171</span><span class="p">]</span>
<span class="n">refseq_exp2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NM_002121&quot;</span><span class="p">,</span><span class="s2">&quot;NR_072994&quot;</span><span class="p">,</span><span class="s2">&quot;NR_031601&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001290043&quot;</span><span class="p">,</span><span class="s2">&quot;NM_002441&quot;</span><span class="p">,</span><span class="s2">&quot;NM_018842&quot;</span><span class="p">,</span><span class="s2">&quot;NM_178828&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001007&quot;</span><span class="p">,</span><span class="s2">&quot;NR_030258&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001184924&quot;</span><span class="p">]</span>

<span class="n">df_peaks_exp2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df_peaks_exp2</span><span class="p">[</span><span class="s1">&#39;chr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">chr_exp2</span>
<span class="n">df_peaks_exp2</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_exp2</span>
<span class="n">df_peaks_exp2</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_exp2</span>
<span class="n">df_peaks_exp2</span><span class="p">[</span><span class="s1">&#39;refseq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">refseq_exp2</span>
</pre></div>
</div>
</div>
</div>
<p>Look at both DataFrames. The <code class="docutils literal notranslate"><span class="pre">head()</span></code> function shows the first five rows of a DataFrame.</p>
<p>They have the same column layout (<code class="docutils literal notranslate"><span class="pre">chr</span></code>, <code class="docutils literal notranslate"><span class="pre">start</span></code>, <code class="docutils literal notranslate"><span class="pre">end</span></code>, <code class="docutils literal notranslate"><span class="pre">refseq</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_peaks_exp1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>refseq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chr1</td>
      <td>43232415</td>
      <td>43233415</td>
      <td>NM_024097</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chr11</td>
      <td>74459412</td>
      <td>74460412</td>
      <td>NM_001098638</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chr11</td>
      <td>77774406</td>
      <td>77775406</td>
      <td>NM_003251</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chr11</td>
      <td>131780211</td>
      <td>131781211</td>
      <td>NM_016522</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chr13</td>
      <td>20806034</td>
      <td>20807034</td>
      <td>NM_001110221</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_peaks_exp2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>refseq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chr6_dbb_hap3</td>
      <td>4324541</td>
      <td>4325541</td>
      <td>NM_002121</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chr6_mann_hap4</td>
      <td>1932656</td>
      <td>1933656</td>
      <td>NR_072994</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chr6_qbl_hap6</td>
      <td>3218006</td>
      <td>3219006</td>
      <td>NR_031601</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chr6_qbl_hap6</td>
      <td>4038208</td>
      <td>4039208</td>
      <td>NM_001290043</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chr6_ssto_hap7</td>
      <td>3038042</td>
      <td>3039042</td>
      <td>NM_002441</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>They both represent peaks of a ChIP-seq experiment.</p>
<p>For both DataFrames we can add an additional column indicating from which experiment the data comes (‘exp1’ or ‘exp2’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_peaks_exp1</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;exp1&#39;</span>
<span class="n">df_peaks_exp2</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;exp2&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Take a look at the two DataFrames, and note how we did this:</p>
<ul class="simple">
<li><p>We used <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> to define a new colum, with the column name between <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code></p></li>
<li><p>We only used only one string (<code class="docutils literal notranslate"><span class="pre">'exp1'</span></code>), but this was automatically expanded to the whole column</p></li>
</ul>
</div>
<div class="section" id="creating-a-pandas-dataframe-using-a-dictionary">
<h2>Creating a pandas DataFrame using a <code class="docutils literal notranslate"><span class="pre">dictionary</span></code><a class="headerlink" href="#creating-a-pandas-dataframe-using-a-dictionary" title="Permalink to this headline">¶</a></h2>
<p>We can also create a pandas DataFrame from a dictionary. The dictionary should contain <em>column names as keys</em> and <em>lists as values</em> for the columns. To show this in action, we will use the three following lists:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">refseq</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NM_001007&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001098638&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001110221&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001126112&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001142599&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001164283&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001164386&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001184924&quot;</span><span class="p">,</span><span class="s2">&quot;NM_001290043&quot;</span><span class="p">,</span><span class="s2">&quot;NM_002121&quot;</span><span class="p">,</span><span class="s2">&quot;NM_002441&quot;</span><span class="p">,</span><span class="s2">&quot;NM_003251&quot;</span><span class="p">,</span><span class="s2">&quot;NM_003352&quot;</span><span class="p">,</span><span class="s2">&quot;NM_004263&quot;</span><span class="p">,</span><span class="s2">&quot;NM_005165&quot;</span><span class="p">,</span><span class="s2">&quot;NM_006017&quot;</span><span class="p">,</span><span class="s2">&quot;NM_007145&quot;</span><span class="p">,</span><span class="s2">&quot;NM_016522&quot;</span><span class="p">,</span><span class="s2">&quot;NM_018842&quot;</span><span class="p">,</span><span class="s2">&quot;NM_024097&quot;</span><span class="p">,</span><span class="s2">&quot;NM_147181&quot;</span><span class="p">,</span><span class="s2">&quot;NM_173856&quot;</span><span class="p">,</span><span class="s2">&quot;NM_178828&quot;</span><span class="p">]</span>

<span class="n">ensembl</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ENSG00000198034&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000166439&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000121742&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000141510&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000072682&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000056972&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000158987&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000198883&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000225967&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000237710&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000235569&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000151365&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000116030&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000135622&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000109107&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000007062&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000167635&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000182667&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000006453&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000164008&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000185774&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000196131&quot;</span><span class="p">,</span><span class="s2">&quot;ENSG00000177992&quot;</span><span class="p">]</span>

<span class="n">genename</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RPS4X&quot;</span><span class="p">,</span><span class="s2">&quot;RNF169&quot;</span><span class="p">,</span><span class="s2">&quot;GJB6&quot;</span><span class="p">,</span><span class="s2">&quot;TP53&quot;</span><span class="p">,</span><span class="s2">&quot;P4HA2&quot;</span><span class="p">,</span><span class="s2">&quot;TRAF3IP2&quot;</span><span class="p">,</span><span class="s2">&quot;RAPGEF6&quot;</span><span class="p">,</span><span class="s2">&quot;PNMA5&quot;</span><span class="p">,</span><span class="s2">&quot;TAP2&quot;</span><span class="p">,</span><span class="s2">&quot;HLA-DPB1&quot;</span><span class="p">,</span><span class="s2">&quot;MSH5&quot;</span><span class="p">,</span><span class="s2">&quot;THRSP&quot;</span><span class="p">,</span><span class="s2">&quot;SUMO1&quot;</span><span class="p">,</span><span class="s2">&quot;SEMA4F&quot;</span><span class="p">,</span><span class="s2">&quot;ALDOC&quot;</span><span class="p">,</span><span class="s2">&quot;PROM1&quot;</span><span class="p">,</span><span class="s2">&quot;ZNF146&quot;</span><span class="p">,</span><span class="s2">&quot;NTM&quot;</span><span class="p">,</span><span class="s2">&quot;BAIAP2L1&quot;</span><span class="p">,</span><span class="s2">&quot;C1orf50&quot;</span><span class="p">,</span><span class="s2">&quot;KCNIP4&quot;</span><span class="p">,</span><span class="s2">&quot;VN1R2&quot;</span><span class="p">,</span><span class="s2">&quot;SPATA31E1&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>First, we use these lists to create a dictionary</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dict_genes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;refseq&#39;</span><span class="p">:</span> <span class="n">refseq</span><span class="p">,</span>
    <span class="s1">&#39;ensembl&#39;</span><span class="p">:</span> <span class="n">ensembl</span><span class="p">,</span>
    <span class="s1">&#39;genename&#39;</span><span class="p">:</span> <span class="n">genename</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have the dictionary, we can create the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_genes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dict_genes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Look at the resulting DataFrame called <code class="docutils literal notranslate"><span class="pre">df_genes</span></code>. This DataFrame will help us to map RefSeq to ENSEMBL gene identifiers.</p>
<p>Next, we create another DataFrame with gene expression values</p>
<p>Again, we will use a dictionary for this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ensembl_1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ENSG00000237710&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000182667&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000121742&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000158987&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000196131&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000151365&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000056972&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000235569&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000006453&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000198883&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000225967&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000166439&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000135622&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000007062&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000109107&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000167635&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000164008&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000141510&quot;</span><span class="p">,</span> <span class="s2">&quot;ENSG00000177992&quot;</span><span class="p">]</span>

<span class="n">sample_1</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.686</span><span class="p">,</span> <span class="mf">0.063</span><span class="p">,</span> <span class="mf">4.222</span><span class="p">,</span> <span class="mf">0.021</span><span class="p">,</span> <span class="mf">0.026</span><span class="p">,</span> <span class="mf">8.169</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">16.159</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">3.972</span><span class="p">,</span> <span class="mf">0.844</span><span class="p">,</span> <span class="mf">26.208</span><span class="p">,</span> <span class="mf">18.218</span><span class="p">,</span> <span class="mf">91.049</span><span class="p">,</span> <span class="mf">3.828</span><span class="p">,</span> <span class="mf">58.697</span><span class="p">,</span> <span class="mf">0.024</span><span class="p">]</span>

<span class="n">sample_2</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">0.011</span><span class="p">,</span> <span class="mf">4.291</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.013</span><span class="p">,</span> <span class="mf">0.306</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">12.671</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">6.983</span><span class="p">,</span> <span class="mf">5.352</span><span class="p">,</span> <span class="mf">14.336</span><span class="p">,</span> <span class="mf">5.333</span><span class="p">,</span> <span class="mf">60.28</span><span class="p">,</span> <span class="mf">5.137</span><span class="p">,</span> <span class="mf">47.569</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">sample_3</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">6.865</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.727</span><span class="p">,</span> <span class="mf">0.039</span><span class="p">,</span> <span class="mf">0.023</span><span class="p">,</span> <span class="mf">10.459</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">,</span> <span class="mf">0.011</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">7.007</span><span class="p">,</span> <span class="mf">3.402</span><span class="p">,</span> <span class="mf">6.076</span><span class="p">,</span> <span class="mf">18.445</span><span class="p">,</span> <span class="mf">28.716</span><span class="p">,</span> <span class="mf">4.128</span><span class="p">,</span> <span class="mf">34.299</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">sample_4</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mf">15.691</span><span class="p">,</span> <span class="mf">2.16</span><span class="p">,</span> <span class="mf">5.284</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.181</span><span class="p">,</span> <span class="mf">1.428</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">0.184</span><span class="p">,</span> <span class="mf">0.395</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mf">11.842</span><span class="p">,</span> <span class="mf">4.186</span><span class="p">,</span> <span class="mf">6.01</span><span class="p">,</span> <span class="mf">131.013</span><span class="p">,</span> <span class="mf">25.126</span><span class="p">,</span> <span class="mf">9.933</span><span class="p">,</span> <span class="mf">28.18</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dict_expr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ensembl&#39;</span><span class="p">:</span> <span class="n">ensembl_1</span><span class="p">,</span> <span class="s1">&#39;sample1&#39;</span><span class="p">:</span> <span class="n">sample_1</span><span class="p">,</span> <span class="s1">&#39;sample2&#39;</span><span class="p">:</span> <span class="n">sample_2</span><span class="p">,</span> <span class="s1">&#39;sample3&#39;</span><span class="p">:</span> <span class="n">sample_3</span><span class="p">,</span> <span class="s1">&#39;sample4&#39;</span><span class="p">:</span> <span class="n">sample_4</span><span class="p">}</span>
<span class="n">df_expr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dict_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="merging-pandas-dataframes">
<h2>Merging pandas DataFrames<a class="headerlink" href="#merging-pandas-dataframes" title="Permalink to this headline">¶</a></h2>
<p>Look at the DataFrames using print (or by just typing the DataFrame name followed by Enter)</p>
<p>In case we would have very long DataFrames, can use <code class="docutils literal notranslate"><span class="pre">df.head()</span></code> (where <code class="docutils literal notranslate"><span class="pre">df</span></code> is your DataFrame name)</p>
</div>
<div class="section" id="merging-dataframes-on-column-values">
<h2>Merging DataFrames on column values<a class="headerlink" href="#merging-dataframes-on-column-values" title="Permalink to this headline">¶</a></h2>
<p>We now have 3 types of data in our 3 DataFrames:</p>
<ul class="simple">
<li><p>ChIP-seq peaks (<code class="docutils literal notranslate"><span class="pre">df_peaks</span></code>)</p></li>
<li><p>A RefSeq to ENSEMBL gene identifier mapping (<code class="docutils literal notranslate"><span class="pre">df_genes</span></code>)</p></li>
<li><p>Expression values of genes in 4 samples, with ENSEMBL identifiers (<code class="docutils literal notranslate"><span class="pre">df_expr</span></code>)</p></li>
</ul>
<p>This is a typical example for any (bioinformatical) analysis in which you want to incorporate different data types, often from different sources. You need to merge them if you want to do anything useful. Pandas DataFrames can be of big help here.</p>
<p>So let us try to merge these pieces of data</p>
</div>
<div class="section" id="merging-dataframes-concat">
<h2>Merging DataFrames: <code class="docutils literal notranslate"><span class="pre">concat</span></code><a class="headerlink" href="#merging-dataframes-concat" title="Permalink to this headline">¶</a></h2>
<p>Using the command <code class="docutils literal notranslate"><span class="pre">concat</span></code> we can concatenate multiple DataFrames.
Let us do this with the 2 ChIP-seq peaks DataFrames:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_peaks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_peaks_exp1</span><span class="p">,</span> <span class="n">df_peaks_exp2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Check out the result, and note how the <code class="docutils literal notranslate"><span class="pre">exp</span></code> column still allows us to distinghuish the two experiments.</p>
<p>Next, we merge the ChIP-seq peaks with the gene identifier mappings, using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> function</p>
</div>
<div class="section" id="merging-dataframes-merge">
<h2>Merging DataFrames: <code class="docutils literal notranslate"><span class="pre">merge</span></code><a class="headerlink" href="#merging-dataframes-merge" title="Permalink to this headline">¶</a></h2>
<p>Here we will merge the three different DataFrames (<code class="docutils literal notranslate"><span class="pre">df_peaks</span></code>, <code class="docutils literal notranslate"><span class="pre">df_genes</span></code>, <code class="docutils literal notranslate"><span class="pre">df_expr</span></code>) using the gene identifiers. Note that we have two different gene identifiers (RefSeq and ENSEMBL).</p>
<p>First, we merge <code class="docutils literal notranslate"><span class="pre">df_peaks</span></code> with <code class="docutils literal notranslate"><span class="pre">df_genes</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_genes_peaks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_genes</span><span class="p">,</span> <span class="n">df_peaks</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;refseq&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Check the resulting DataFrame.
Our DataFrame now has the ENSEMBL gene identifiers, so we can also merge the <code class="docutils literal notranslate"><span class="pre">df_expr</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_genes_peaks_expr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_genes_peaks</span><span class="p">,</span> <span class="n">df_expr</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;ensembl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For convenience, we will use a shorter name for our merged DataFrame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span>  <span class="o">=</span> <span class="n">df_genes_peaks_expr</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tab-completion-and-help">
<h2>Tab completion and help<a class="headerlink" href="#tab-completion-and-help" title="Permalink to this headline">¶</a></h2>
<p>Now that we have merged our data, we can do several neat things.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">df_all</span></code> is a pandas DataFrame, it automatically inherits DataFrame methods.</p>
<p>You can get an idea if you type:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df_all.
</pre></div>
</div>
<p>And then hit the left &lt;Tab&gt; key.</p>
<p>Notice that you get a lot of options….</p>
<p>Suppose you want to know how the <code class="docutils literal notranslate"><span class="pre">sort_values()</span></code> method for a DataFrame works. You can type:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>df_all.sort_values?
</pre></div>
</div>
<p>This HELP menu gives you information about the function. type ‘q’ or &lt;ESC&gt; to leave the HELP</p>
</div>
<div class="section" id="sorting-a-dataframe">
<h2>Sorting a DataFrame<a class="headerlink" href="#sorting-a-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Let us try it out:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;chr&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>refseq</th>
      <th>ensembl</th>
      <th>genename</th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>exp</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>16</th>
      <td>NM_024097</td>
      <td>ENSG00000164008</td>
      <td>C1orf50</td>
      <td>chr1</td>
      <td>43232415</td>
      <td>43233415</td>
      <td>exp1</td>
      <td>3.828</td>
      <td>5.137</td>
      <td>4.128</td>
      <td>9.933</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NM_001098638</td>
      <td>ENSG00000166439</td>
      <td>RNF169</td>
      <td>chr11</td>
      <td>74459412</td>
      <td>74460412</td>
      <td>exp1</td>
      <td>3.972</td>
      <td>6.983</td>
      <td>7.007</td>
      <td>11.842</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NM_016522</td>
      <td>ENSG00000182667</td>
      <td>NTM</td>
      <td>chr11</td>
      <td>131780211</td>
      <td>131781211</td>
      <td>exp1</td>
      <td>1.686</td>
      <td>1.159</td>
      <td>6.865</td>
      <td>15.691</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NM_003251</td>
      <td>ENSG00000151365</td>
      <td>THRSP</td>
      <td>chr11</td>
      <td>77774406</td>
      <td>77775406</td>
      <td>exp1</td>
      <td>0.026</td>
      <td>0.013</td>
      <td>0.023</td>
      <td>0.181</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NM_001110221</td>
      <td>ENSG00000121742</td>
      <td>GJB6</td>
      <td>chr13</td>
      <td>20806034</td>
      <td>20807034</td>
      <td>exp1</td>
      <td>0.063</td>
      <td>0.011</td>
      <td>0.000</td>
      <td>2.160</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NM_005165</td>
      <td>ENSG00000109107</td>
      <td>ALDOC</td>
      <td>chr17</td>
      <td>26903451</td>
      <td>26904451</td>
      <td>exp1</td>
      <td>18.218</td>
      <td>5.333</td>
      <td>18.445</td>
      <td>131.013</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NM_001126112</td>
      <td>ENSG00000141510</td>
      <td>TP53</td>
      <td>chr17</td>
      <td>7590368</td>
      <td>7591368</td>
      <td>exp1</td>
      <td>58.697</td>
      <td>47.569</td>
      <td>34.299</td>
      <td>28.180</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NM_173856</td>
      <td>ENSG00000196131</td>
      <td>VN1R2</td>
      <td>chr19</td>
      <td>53761044</td>
      <td>53762044</td>
      <td>exp1</td>
      <td>0.021</td>
      <td>0.004</td>
      <td>0.039</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NM_007145</td>
      <td>ENSG00000167635</td>
      <td>ZNF146</td>
      <td>chr19</td>
      <td>36705003</td>
      <td>36706003</td>
      <td>exp1</td>
      <td>91.049</td>
      <td>60.280</td>
      <td>28.716</td>
      <td>25.126</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NM_004263</td>
      <td>ENSG00000135622</td>
      <td>SEMA4F</td>
      <td>chr2</td>
      <td>74880854</td>
      <td>74881854</td>
      <td>exp1</td>
      <td>0.844</td>
      <td>5.352</td>
      <td>3.402</td>
      <td>4.186</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NM_006017</td>
      <td>ENSG00000007062</td>
      <td>PROM1</td>
      <td>chr4</td>
      <td>16077241</td>
      <td>16078241</td>
      <td>exp1</td>
      <td>26.208</td>
      <td>14.336</td>
      <td>6.076</td>
      <td>6.010</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NM_001164386</td>
      <td>ENSG00000158987</td>
      <td>RAPGEF6</td>
      <td>chr5</td>
      <td>130970429</td>
      <td>130971429</td>
      <td>exp1</td>
      <td>4.222</td>
      <td>4.291</td>
      <td>4.727</td>
      <td>5.284</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NM_001164283</td>
      <td>ENSG00000056972</td>
      <td>TRAF3IP2</td>
      <td>chr6</td>
      <td>111888063</td>
      <td>111889063</td>
      <td>exp1</td>
      <td>8.169</td>
      <td>0.306</td>
      <td>10.459</td>
      <td>1.428</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NM_002121</td>
      <td>ENSG00000237710</td>
      <td>HLA-DPB1</td>
      <td>chr6_dbb_hap3</td>
      <td>4324541</td>
      <td>4325541</td>
      <td>exp2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NM_001290043</td>
      <td>ENSG00000225967</td>
      <td>TAP2</td>
      <td>chr6_qbl_hap6</td>
      <td>4038208</td>
      <td>4039208</td>
      <td>exp2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NM_002441</td>
      <td>ENSG00000235569</td>
      <td>MSH5</td>
      <td>chr6_ssto_hap7</td>
      <td>3038042</td>
      <td>3039042</td>
      <td>exp2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NM_018842</td>
      <td>ENSG00000006453</td>
      <td>BAIAP2L1</td>
      <td>chr7</td>
      <td>98029927</td>
      <td>98030927</td>
      <td>exp2</td>
      <td>16.159</td>
      <td>12.671</td>
      <td>0.225</td>
      <td>0.184</td>
    </tr>
    <tr>
      <th>18</th>
      <td>NM_178828</td>
      <td>ENSG00000177992</td>
      <td>SPATA31E1</td>
      <td>chr9</td>
      <td>90497271</td>
      <td>90498271</td>
      <td>exp2</td>
      <td>0.024</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NM_001184924</td>
      <td>ENSG00000198883</td>
      <td>PNMA5</td>
      <td>chrX</td>
      <td>152162171</td>
      <td>152163171</td>
      <td>exp2</td>
      <td>0.080</td>
      <td>0.000</td>
      <td>0.011</td>
      <td>0.395</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>or</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>refseq</th>
      <th>ensembl</th>
      <th>genename</th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>exp</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>NM_002441</td>
      <td>ENSG00000235569</td>
      <td>MSH5</td>
      <td>chr6_ssto_hap7</td>
      <td>3038042</td>
      <td>3039042</td>
      <td>exp2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NM_001290043</td>
      <td>ENSG00000225967</td>
      <td>TAP2</td>
      <td>chr6_qbl_hap6</td>
      <td>4038208</td>
      <td>4039208</td>
      <td>exp2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NM_002121</td>
      <td>ENSG00000237710</td>
      <td>HLA-DPB1</td>
      <td>chr6_dbb_hap3</td>
      <td>4324541</td>
      <td>4325541</td>
      <td>exp2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NM_001126112</td>
      <td>ENSG00000141510</td>
      <td>TP53</td>
      <td>chr17</td>
      <td>7590368</td>
      <td>7591368</td>
      <td>exp1</td>
      <td>58.697</td>
      <td>47.569</td>
      <td>34.299</td>
      <td>28.180</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NM_006017</td>
      <td>ENSG00000007062</td>
      <td>PROM1</td>
      <td>chr4</td>
      <td>16077241</td>
      <td>16078241</td>
      <td>exp1</td>
      <td>26.208</td>
      <td>14.336</td>
      <td>6.076</td>
      <td>6.010</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NM_001110221</td>
      <td>ENSG00000121742</td>
      <td>GJB6</td>
      <td>chr13</td>
      <td>20806034</td>
      <td>20807034</td>
      <td>exp1</td>
      <td>0.063</td>
      <td>0.011</td>
      <td>0.000</td>
      <td>2.160</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NM_005165</td>
      <td>ENSG00000109107</td>
      <td>ALDOC</td>
      <td>chr17</td>
      <td>26903451</td>
      <td>26904451</td>
      <td>exp1</td>
      <td>18.218</td>
      <td>5.333</td>
      <td>18.445</td>
      <td>131.013</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NM_007145</td>
      <td>ENSG00000167635</td>
      <td>ZNF146</td>
      <td>chr19</td>
      <td>36705003</td>
      <td>36706003</td>
      <td>exp1</td>
      <td>91.049</td>
      <td>60.280</td>
      <td>28.716</td>
      <td>25.126</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NM_024097</td>
      <td>ENSG00000164008</td>
      <td>C1orf50</td>
      <td>chr1</td>
      <td>43232415</td>
      <td>43233415</td>
      <td>exp1</td>
      <td>3.828</td>
      <td>5.137</td>
      <td>4.128</td>
      <td>9.933</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NM_173856</td>
      <td>ENSG00000196131</td>
      <td>VN1R2</td>
      <td>chr19</td>
      <td>53761044</td>
      <td>53762044</td>
      <td>exp1</td>
      <td>0.021</td>
      <td>0.004</td>
      <td>0.039</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>NM_001098638</td>
      <td>ENSG00000166439</td>
      <td>RNF169</td>
      <td>chr11</td>
      <td>74459412</td>
      <td>74460412</td>
      <td>exp1</td>
      <td>3.972</td>
      <td>6.983</td>
      <td>7.007</td>
      <td>11.842</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NM_004263</td>
      <td>ENSG00000135622</td>
      <td>SEMA4F</td>
      <td>chr2</td>
      <td>74880854</td>
      <td>74881854</td>
      <td>exp1</td>
      <td>0.844</td>
      <td>5.352</td>
      <td>3.402</td>
      <td>4.186</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NM_003251</td>
      <td>ENSG00000151365</td>
      <td>THRSP</td>
      <td>chr11</td>
      <td>77774406</td>
      <td>77775406</td>
      <td>exp1</td>
      <td>0.026</td>
      <td>0.013</td>
      <td>0.023</td>
      <td>0.181</td>
    </tr>
    <tr>
      <th>18</th>
      <td>NM_178828</td>
      <td>ENSG00000177992</td>
      <td>SPATA31E1</td>
      <td>chr9</td>
      <td>90497271</td>
      <td>90498271</td>
      <td>exp2</td>
      <td>0.024</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NM_018842</td>
      <td>ENSG00000006453</td>
      <td>BAIAP2L1</td>
      <td>chr7</td>
      <td>98029927</td>
      <td>98030927</td>
      <td>exp2</td>
      <td>16.159</td>
      <td>12.671</td>
      <td>0.225</td>
      <td>0.184</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NM_001164283</td>
      <td>ENSG00000056972</td>
      <td>TRAF3IP2</td>
      <td>chr6</td>
      <td>111888063</td>
      <td>111889063</td>
      <td>exp1</td>
      <td>8.169</td>
      <td>0.306</td>
      <td>10.459</td>
      <td>1.428</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NM_001164386</td>
      <td>ENSG00000158987</td>
      <td>RAPGEF6</td>
      <td>chr5</td>
      <td>130970429</td>
      <td>130971429</td>
      <td>exp1</td>
      <td>4.222</td>
      <td>4.291</td>
      <td>4.727</td>
      <td>5.284</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NM_016522</td>
      <td>ENSG00000182667</td>
      <td>NTM</td>
      <td>chr11</td>
      <td>131780211</td>
      <td>131781211</td>
      <td>exp1</td>
      <td>1.686</td>
      <td>1.159</td>
      <td>6.865</td>
      <td>15.691</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NM_001184924</td>
      <td>ENSG00000198883</td>
      <td>PNMA5</td>
      <td>chrX</td>
      <td>152162171</td>
      <td>152163171</td>
      <td>exp2</td>
      <td>0.080</td>
      <td>0.000</td>
      <td>0.011</td>
      <td>0.395</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that these commands did not replace the original DataFrame <code class="docutils literal notranslate"><span class="pre">df_all</span></code>!</p>
</div>
<div class="section" id="using-to-obtain-dataframe-columns-or-rows">
<h2>Using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> to obtain DataFrame columns or rows<a class="headerlink" href="#using-to-obtain-dataframe-columns-or-rows" title="Permalink to this headline">¶</a></h2>
<p>Using <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> we can obtain specific parts of the DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;genename&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0        RNF169
1          GJB6
2          TP53
3      TRAF3IP2
4       RAPGEF6
5         PNMA5
6          TAP2
7      HLA-DPB1
8          MSH5
9         THRSP
10       SEMA4F
11        ALDOC
12        PROM1
13       ZNF146
14          NTM
15     BAIAP2L1
16      C1orf50
17        VN1R2
18    SPATA31E1
Name: genename, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## or, for multiple columns:</span>
<span class="n">df_all</span><span class="p">[[</span><span class="s1">&#39;genename&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>genename</th>
      <th>exp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RNF169</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GJB6</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TP53</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TRAF3IP2</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RAPGEF6</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PNMA5</td>
      <td>exp2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TAP2</td>
      <td>exp2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>HLA-DPB1</td>
      <td>exp2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>MSH5</td>
      <td>exp2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>THRSP</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>SEMA4F</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ALDOC</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>PROM1</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>ZNF146</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NTM</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>BAIAP2L1</td>
      <td>exp2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>C1orf50</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>VN1R2</td>
      <td>exp1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>SPATA31E1</td>
      <td>exp2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">iloc</span></code> we can do the same using indexes</p>
<p>One index by default points to <strong>rows</strong> of a DataFrame</p>
<p>To get the 2nd row, type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>refseq         NM_001126112
ensembl     ENSG00000141510
genename               TP53
chr                   chr17
start               7590368
end                 7591368
exp                    exp1
sample1              58.697
sample2              47.569
sample3              34.299
sample4               28.18
Name: 2, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Or, for multiple rows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>refseq</th>
      <th>ensembl</th>
      <th>genename</th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>exp</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>NM_001126112</td>
      <td>ENSG00000141510</td>
      <td>TP53</td>
      <td>chr17</td>
      <td>7590368</td>
      <td>7591368</td>
      <td>exp1</td>
      <td>58.697</td>
      <td>47.569</td>
      <td>34.299</td>
      <td>28.180</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NM_001164283</td>
      <td>ENSG00000056972</td>
      <td>TRAF3IP2</td>
      <td>chr6</td>
      <td>111888063</td>
      <td>111889063</td>
      <td>exp1</td>
      <td>8.169</td>
      <td>0.306</td>
      <td>10.459</td>
      <td>1.428</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NM_001164386</td>
      <td>ENSG00000158987</td>
      <td>RAPGEF6</td>
      <td>chr5</td>
      <td>130970429</td>
      <td>130971429</td>
      <td>exp1</td>
      <td>4.222</td>
      <td>4.291</td>
      <td>4.727</td>
      <td>5.284</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This works very much like indexes of a <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
<p>If you use two indices, you can obtain specific rows <em>and</em> columns.</p>
<p>The first index is always <em>rows</em>, the second <em>columns</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>start</th>
      <th>end</th>
      <th>exp</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>7590368</td>
      <td>7591368</td>
      <td>exp1</td>
      <td>58.697</td>
      <td>47.569</td>
      <td>34.299</td>
      <td>28.180</td>
    </tr>
    <tr>
      <th>3</th>
      <td>111888063</td>
      <td>111889063</td>
      <td>exp1</td>
      <td>8.169</td>
      <td>0.306</td>
      <td>10.459</td>
      <td>1.428</td>
    </tr>
    <tr>
      <th>4</th>
      <td>130970429</td>
      <td>130971429</td>
      <td>exp1</td>
      <td>4.222</td>
      <td>4.291</td>
      <td>4.727</td>
      <td>5.284</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="removing-missing-values-or-nans">
<h2>Removing missing values or <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s.<a class="headerlink" href="#removing-missing-values-or-nans" title="Permalink to this headline">¶</a></h2>
<p>In many cases DataFrames contains <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, missing values, and you often have to remove them.</p>
<p>We have several such <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s in <code class="docutils literal notranslate"><span class="pre">df_all</span></code>.</p>
<p>We can obtain a <code class="docutils literal notranslate"><span class="pre">boolean</span></code> (True/False) for the column called ‘sample1’ like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;sample1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0     False
1     False
2     False
3     False
4     False
5     False
6      True
7      True
8      True
9     False
10    False
11    False
12    False
13    False
14    False
15    False
16    False
17    False
18    False
Name: sample1, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>By using the <code class="docutils literal notranslate"><span class="pre">~</span></code> symbol we can invert this <code class="docutils literal notranslate"><span class="pre">boolean</span></code> column. The <code class="docutils literal notranslate"><span class="pre">~</span></code> acts as <code class="docutils literal notranslate"><span class="pre">not</span></code> for a pandas Series.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">~</span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;sample1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>0      True
1      True
2      True
3      True
4      True
5      True
6     False
7     False
8     False
9      True
10     True
11     True
12     True
13     True
14     True
15     True
16     True
17     True
18     True
Name: sample1, dtype: bool
</pre></div>
</div>
</div>
</div>
<p>We can use this strategy to remove all rows that have <code class="docutils literal notranslate"><span class="pre">NaN</span></code> in the column <code class="docutils literal notranslate"><span class="pre">sample1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="p">[</span><span class="o">~</span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;sample1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>refseq</th>
      <th>ensembl</th>
      <th>genename</th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>exp</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NM_001098638</td>
      <td>ENSG00000166439</td>
      <td>RNF169</td>
      <td>chr11</td>
      <td>74459412</td>
      <td>74460412</td>
      <td>exp1</td>
      <td>3.972</td>
      <td>6.983</td>
      <td>7.007</td>
      <td>11.842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NM_001110221</td>
      <td>ENSG00000121742</td>
      <td>GJB6</td>
      <td>chr13</td>
      <td>20806034</td>
      <td>20807034</td>
      <td>exp1</td>
      <td>0.063</td>
      <td>0.011</td>
      <td>0.000</td>
      <td>2.160</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NM_001126112</td>
      <td>ENSG00000141510</td>
      <td>TP53</td>
      <td>chr17</td>
      <td>7590368</td>
      <td>7591368</td>
      <td>exp1</td>
      <td>58.697</td>
      <td>47.569</td>
      <td>34.299</td>
      <td>28.180</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NM_001164283</td>
      <td>ENSG00000056972</td>
      <td>TRAF3IP2</td>
      <td>chr6</td>
      <td>111888063</td>
      <td>111889063</td>
      <td>exp1</td>
      <td>8.169</td>
      <td>0.306</td>
      <td>10.459</td>
      <td>1.428</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NM_001164386</td>
      <td>ENSG00000158987</td>
      <td>RAPGEF6</td>
      <td>chr5</td>
      <td>130970429</td>
      <td>130971429</td>
      <td>exp1</td>
      <td>4.222</td>
      <td>4.291</td>
      <td>4.727</td>
      <td>5.284</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NM_001184924</td>
      <td>ENSG00000198883</td>
      <td>PNMA5</td>
      <td>chrX</td>
      <td>152162171</td>
      <td>152163171</td>
      <td>exp2</td>
      <td>0.080</td>
      <td>0.000</td>
      <td>0.011</td>
      <td>0.395</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NM_003251</td>
      <td>ENSG00000151365</td>
      <td>THRSP</td>
      <td>chr11</td>
      <td>77774406</td>
      <td>77775406</td>
      <td>exp1</td>
      <td>0.026</td>
      <td>0.013</td>
      <td>0.023</td>
      <td>0.181</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NM_004263</td>
      <td>ENSG00000135622</td>
      <td>SEMA4F</td>
      <td>chr2</td>
      <td>74880854</td>
      <td>74881854</td>
      <td>exp1</td>
      <td>0.844</td>
      <td>5.352</td>
      <td>3.402</td>
      <td>4.186</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NM_005165</td>
      <td>ENSG00000109107</td>
      <td>ALDOC</td>
      <td>chr17</td>
      <td>26903451</td>
      <td>26904451</td>
      <td>exp1</td>
      <td>18.218</td>
      <td>5.333</td>
      <td>18.445</td>
      <td>131.013</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NM_006017</td>
      <td>ENSG00000007062</td>
      <td>PROM1</td>
      <td>chr4</td>
      <td>16077241</td>
      <td>16078241</td>
      <td>exp1</td>
      <td>26.208</td>
      <td>14.336</td>
      <td>6.076</td>
      <td>6.010</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NM_007145</td>
      <td>ENSG00000167635</td>
      <td>ZNF146</td>
      <td>chr19</td>
      <td>36705003</td>
      <td>36706003</td>
      <td>exp1</td>
      <td>91.049</td>
      <td>60.280</td>
      <td>28.716</td>
      <td>25.126</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NM_016522</td>
      <td>ENSG00000182667</td>
      <td>NTM</td>
      <td>chr11</td>
      <td>131780211</td>
      <td>131781211</td>
      <td>exp1</td>
      <td>1.686</td>
      <td>1.159</td>
      <td>6.865</td>
      <td>15.691</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NM_018842</td>
      <td>ENSG00000006453</td>
      <td>BAIAP2L1</td>
      <td>chr7</td>
      <td>98029927</td>
      <td>98030927</td>
      <td>exp2</td>
      <td>16.159</td>
      <td>12.671</td>
      <td>0.225</td>
      <td>0.184</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NM_024097</td>
      <td>ENSG00000164008</td>
      <td>C1orf50</td>
      <td>chr1</td>
      <td>43232415</td>
      <td>43233415</td>
      <td>exp1</td>
      <td>3.828</td>
      <td>5.137</td>
      <td>4.128</td>
      <td>9.933</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NM_173856</td>
      <td>ENSG00000196131</td>
      <td>VN1R2</td>
      <td>chr19</td>
      <td>53761044</td>
      <td>53762044</td>
      <td>exp1</td>
      <td>0.021</td>
      <td>0.004</td>
      <td>0.039</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>18</th>
      <td>NM_178828</td>
      <td>ENSG00000177992</td>
      <td>SPATA31E1</td>
      <td>chr9</td>
      <td>90497271</td>
      <td>90498271</td>
      <td>exp2</td>
      <td>0.024</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Make sure you understand how this worked!</p>
<p>We can do the same for getting all rows corresponding to <code class="docutils literal notranslate"><span class="pre">exp1</span></code> (experiment 1):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_all</span><span class="p">[</span><span class="n">df_all</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;exp1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>refseq</th>
      <th>ensembl</th>
      <th>genename</th>
      <th>chr</th>
      <th>start</th>
      <th>end</th>
      <th>exp</th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NM_001098638</td>
      <td>ENSG00000166439</td>
      <td>RNF169</td>
      <td>chr11</td>
      <td>74459412</td>
      <td>74460412</td>
      <td>exp1</td>
      <td>3.972</td>
      <td>6.983</td>
      <td>7.007</td>
      <td>11.842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NM_001110221</td>
      <td>ENSG00000121742</td>
      <td>GJB6</td>
      <td>chr13</td>
      <td>20806034</td>
      <td>20807034</td>
      <td>exp1</td>
      <td>0.063</td>
      <td>0.011</td>
      <td>0.000</td>
      <td>2.160</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NM_001126112</td>
      <td>ENSG00000141510</td>
      <td>TP53</td>
      <td>chr17</td>
      <td>7590368</td>
      <td>7591368</td>
      <td>exp1</td>
      <td>58.697</td>
      <td>47.569</td>
      <td>34.299</td>
      <td>28.180</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NM_001164283</td>
      <td>ENSG00000056972</td>
      <td>TRAF3IP2</td>
      <td>chr6</td>
      <td>111888063</td>
      <td>111889063</td>
      <td>exp1</td>
      <td>8.169</td>
      <td>0.306</td>
      <td>10.459</td>
      <td>1.428</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NM_001164386</td>
      <td>ENSG00000158987</td>
      <td>RAPGEF6</td>
      <td>chr5</td>
      <td>130970429</td>
      <td>130971429</td>
      <td>exp1</td>
      <td>4.222</td>
      <td>4.291</td>
      <td>4.727</td>
      <td>5.284</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NM_003251</td>
      <td>ENSG00000151365</td>
      <td>THRSP</td>
      <td>chr11</td>
      <td>77774406</td>
      <td>77775406</td>
      <td>exp1</td>
      <td>0.026</td>
      <td>0.013</td>
      <td>0.023</td>
      <td>0.181</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NM_004263</td>
      <td>ENSG00000135622</td>
      <td>SEMA4F</td>
      <td>chr2</td>
      <td>74880854</td>
      <td>74881854</td>
      <td>exp1</td>
      <td>0.844</td>
      <td>5.352</td>
      <td>3.402</td>
      <td>4.186</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NM_005165</td>
      <td>ENSG00000109107</td>
      <td>ALDOC</td>
      <td>chr17</td>
      <td>26903451</td>
      <td>26904451</td>
      <td>exp1</td>
      <td>18.218</td>
      <td>5.333</td>
      <td>18.445</td>
      <td>131.013</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NM_006017</td>
      <td>ENSG00000007062</td>
      <td>PROM1</td>
      <td>chr4</td>
      <td>16077241</td>
      <td>16078241</td>
      <td>exp1</td>
      <td>26.208</td>
      <td>14.336</td>
      <td>6.076</td>
      <td>6.010</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NM_007145</td>
      <td>ENSG00000167635</td>
      <td>ZNF146</td>
      <td>chr19</td>
      <td>36705003</td>
      <td>36706003</td>
      <td>exp1</td>
      <td>91.049</td>
      <td>60.280</td>
      <td>28.716</td>
      <td>25.126</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NM_016522</td>
      <td>ENSG00000182667</td>
      <td>NTM</td>
      <td>chr11</td>
      <td>131780211</td>
      <td>131781211</td>
      <td>exp1</td>
      <td>1.686</td>
      <td>1.159</td>
      <td>6.865</td>
      <td>15.691</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NM_024097</td>
      <td>ENSG00000164008</td>
      <td>C1orf50</td>
      <td>chr1</td>
      <td>43232415</td>
      <td>43233415</td>
      <td>exp1</td>
      <td>3.828</td>
      <td>5.137</td>
      <td>4.128</td>
      <td>9.933</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NM_173856</td>
      <td>ENSG00000196131</td>
      <td>VN1R2</td>
      <td>chr19</td>
      <td>53761044</td>
      <td>53762044</td>
      <td>exp1</td>
      <td>0.021</td>
      <td>0.004</td>
      <td>0.039</td>
      <td>0.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="basic-calculations">
<h2>Basic calculations<a class="headerlink" href="#basic-calculations" title="Permalink to this headline">¶</a></h2>
<p>There are a lot of methods that allows you to do basic calculation on DataFrames.</p>
<p>As an illustration we will calculate the pairwise correlations between the columns <code class="docutils literal notranslate"><span class="pre">sample1</span></code>, <code class="docutils literal notranslate"><span class="pre">sample2</span></code>, <code class="docutils literal notranslate"><span class="pre">sample3</span></code>, and <code class="docutils literal notranslate"><span class="pre">sample4</span></code>.</p>
<p>We take the appropriate columns first</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_1</span> <span class="o">=</span> <span class="n">df_all</span><span class="p">[[</span><span class="s1">&#39;sample1&#39;</span><span class="p">,</span> <span class="s1">&#39;sample2&#39;</span><span class="p">,</span> <span class="s1">&#39;sample3&#39;</span><span class="p">,</span> <span class="s1">&#39;sample4&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can use the pandas <code class="docutils literal notranslate"><span class="pre">corr</span></code> method to calculate all pairwise correlations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_1</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample1</th>
      <th>sample2</th>
      <th>sample3</th>
      <th>sample4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sample1</th>
      <td>1.000000</td>
      <td>0.978523</td>
      <td>0.862957</td>
      <td>0.253552</td>
    </tr>
    <tr>
      <th>sample2</th>
      <td>0.978523</td>
      <td>1.000000</td>
      <td>0.853166</td>
      <td>0.159854</td>
    </tr>
    <tr>
      <th>sample3</th>
      <td>0.862957</td>
      <td>0.853166</td>
      <td>1.000000</td>
      <td>0.501015</td>
    </tr>
    <tr>
      <th>sample4</th>
      <td>0.253552</td>
      <td>0.159854</td>
      <td>0.501015</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="functions_modules_style.html" title="previous page">Functions and modules</a>
    <a class='right-next' id="next-link" href="visualization.html" title="next page">Visualization</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Simon van Heeringen, Arjen Brinkman, Kees Albers<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>