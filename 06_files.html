

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Files &#8212; NWI-BM066A Computation for Biologists</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">NWI-BM066A Computation for Biologists</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01_introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="02_first_exercises.html">
   First exercises
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_lists.html">
   Lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_loops_control_flow.html">
   Control flow and loops
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Dictionaries
  </a>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="dictionaries_exercises.html">
     Exercises: dictionaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dictionaries_exercises.html#exercises-putting-it-all-together">
     Exercises: Putting it all together
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="files.html">
   Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functions_modules_style.html">
   Functions and modules
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_pandas.html">
   Introduction to pandas DataFrames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_visualization.html">
   Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_footprints.html">
   Creating a DNAseI footprint profile
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_dnase_motifs.html">
   Motifs in DNase I peaks
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/06_files.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-files">
   Introduction to files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#glossary-of-file-terms">
   Glossary of
   <code class="docutils literal notranslate">
    <span class="pre">
     file
    </span>
   </code>
   terms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises-putting-it-all-together">
   <strong>
    Exercises
   </strong>
   : putting it all together
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-6-1">
     <strong>
      Exercise
     </strong>
     6.1 {-}
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="files">
<h1>Files<a class="headerlink" href="#files" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-files">
<h2>Introduction to files<a class="headerlink" href="#introduction-to-files" title="Permalink to this headline">¶</a></h2>
<p>Thus far we have used Python without reading input from files and writing output to files. We have created objects like <code class="docutils literal notranslate"><span class="pre">lists</span></code>, <code class="docutils literal notranslate"><span class="pre">dictionaries</span></code>, but nothing has been saved persistently on a disk, meaning that if we close Python, everything is gone. Usually you want to open a file, read its contents (line by line), analyze it, and write it to another file. To work with files we need the Python <code class="docutils literal notranslate"><span class="pre">file</span></code> object. <code class="docutils literal notranslate"><span class="pre">file</span></code> objects serve as a <strong>link to a file</strong> residing on a disk of a computer.</p>
<p>To open a file, write some contents to it and close it:</p>
<p>Note the following:</p>
<ul class="simple">
<li><p>‘myfile’ is the name of the Python <code class="docutils literal notranslate"><span class="pre">file</span></code> <strong>object</strong></p></li>
<li><p>‘testfile.txt’ is the name of the <strong>file</strong> written to the disk of the computer</p>
<ul>
<li><p>extension is not important, but suggests that it contains text</p></li>
</ul>
</li>
<li><p>The <strong>‘w’</strong> argument to the <code class="docutils literal notranslate"><span class="pre">open</span></code> function opens the file for <strong>writing</strong></p></li>
<li><p>If the file ‘testfile.txt’ already exists, you will overwrite its contents</p></li>
<li><p>If not, the file ‘testfile.txt’ will be created</p></li>
<li><p>You can also use <strong>‘a’</strong> instead, which would <strong>append</strong> any output to the existing file called ‘testfile.txt’</p></li>
<li><p>If you use <strong>‘r’</strong> instead, you only open the file for only <strong>reading</strong> (it has to exist of course)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write</span></code> is a method belonging to the <code class="docutils literal notranslate"><span class="pre">file</span></code> object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write</span></code> does not add a newline character to the end of a line, that is why we add <code class="docutils literal notranslate"><span class="pre">\n</span></code> to our text</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">close</span></code> is a method belonging to the <code class="docutils literal notranslate"><span class="pre">file</span></code> object</p></li>
</ul>
<p>Many files used for our analyses are large. We could open them, store their contents in the memory of computer (RAM) and work on the complete contents. However, in most cases we want to avoid loading all contents into memory, and as most of the files we work with contain lines of text, we rather open the file, process its contents <strong>line-by-line</strong>, and write output to another file.</p>
<p>To open a file and read its contents line-by-line we first open the file using <code class="docutils literal notranslate"><span class="pre">open</span></code>. To step through the file line-by-line we use a <code class="docutils literal notranslate"><span class="pre">for</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code> loop to ‘iterate’ over the resulting <code class="docutils literal notranslate"><span class="pre">file</span></code> object. <strong>Each iteration returns a line of the file, from top to bottom</strong>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">for</span></code> or <code class="docutils literal notranslate"><span class="pre">while</span></code> loop automatically ends as soon as there are no lines anymore (=after the last line).</p>
<p>At the end of the code that you execute for each line, you should close the file.</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">/scratch/cfb/list-dict-loop/example.bed</span></code> is an example BED file. BED files are used to store genomic coordinates along with additional information. BED files are for instance used to store genomic coordinates of ChIP-seq peaks. The first three fields (columns) contain the chromosome, start, and end of the features, respectively. The file <code class="docutils literal notranslate"><span class="pre">/scratch/cfb/list-dict-loop/example.bed</span></code> also contains ‘header’ lines that are used when the file is displayed in the UCSC genome browser. This is not always the case for BED files.</p>
<p>In the next few examples we will see some analysis of this file in action. Each example adds some steps and builds from the previous example.</p>
<p>Example 1:</p>
<ul class="simple">
<li><p>open the <code class="docutils literal notranslate"><span class="pre">/scratch/cfb/list-dict-loop/example.bed</span></code> file</p></li>
<li><p>read the file line-by-line</p></li>
<li><p>ignore header lines starting with ‘browser’ or ‘track’</p></li>
<li><p>split each line into a list</p></li>
<li><p>print each line</p></li>
<li><p>assign the first three elements of this list to the variables ‘chr’, ‘start’, and ‘end’</p></li>
<li><p>print chr start end</p></li>
</ul>
<p>Note how we used <code class="docutils literal notranslate"><span class="pre">startswith</span></code> to check if a string starts with ‘browser’ or ‘track’</p>
<p>Example 2:</p>
<ul class="simple">
<li><p>assign the first three elements of this list to the variables ‘chr’, ‘start’, and ‘end’</p></li>
</ul>
<p>Example 3:</p>
<ul class="simple">
<li><p>convert the ‘start’ and ‘end’ to an integer <code class="docutils literal notranslate"><span class="pre">int</span></code> (they are strings at first)</p></li>
<li><p>calculate the width (size in bases) of each feature</p></li>
</ul>
<p>Example 4:</p>
<ul class="simple">
<li><p>calculate how many features with strand ‘+’ and strand ‘-‘ are present</p></li>
</ul>
<p>Thus far we have used the <code class="docutils literal notranslate"><span class="pre">print</span></code> statement to print output to the screen. But if you want to be more explicit in the formatting of the output, you should use <code class="docutils literal notranslate"><span class="pre">format</span></code>, which creates a <code class="docutils literal notranslate"><span class="pre">string</span></code> that can either be printed or written to a file. The standard way of using <code class="docutils literal notranslate"><span class="pre">format</span></code> is like this: ‘some text {} more text {}’.format(var1, var2). See the following example in which <code class="docutils literal notranslate"><span class="pre">format</span></code> is used:</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">print</span></code> statement by default adds a newline character “\n”. If you write to a file you need to add the newline character “\n” to the <code class="docutils literal notranslate"><span class="pre">string</span></code>:</p>
<p>Note how we also used “\t” here !!</p>
</div>
<div class="section" id="glossary-of-file-terms">
<h2>Glossary of <code class="docutils literal notranslate"><span class="pre">file</span></code> terms<a class="headerlink" href="#glossary-of-file-terms" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">open</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">with</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">while</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startswith</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code></p></li>
</ul>
</div>
<div class="section" id="exercises-putting-it-all-together">
<h2><strong>Exercises</strong>: putting it all together<a class="headerlink" href="#exercises-putting-it-all-together" title="Permalink to this headline">¶</a></h2>
<div class="section" id="exercise-6-1">
<h3><strong>Exercise</strong> 6.1 {-}<a class="headerlink" href="#exercise-6-1" title="Permalink to this headline">¶</a></h3>
<p>In this exercise you are going to analyze data from ChIP-seq of several transcription factors in mouse embryonic stem cells (Chen et al. 2008, 13;133(6):1106-17, PMID 18555785). Please have a look at Figure 1 and 2 of this paper. Figure 1 shows the ChIP-seq profiles for the transcription factors.</p>
<p>The ChIP-seq peaks that you see represent <em>in vivo</em> binding sites of these transcription factors. In Figure 2 the authors have analyzed the DNA sequence underneath these peaks, and identified specific DNA sequences (<strong>motifs</strong>) for each transcription factor.</p>
<p>You are going to analyze these sequences as well, to see which motifs you can identify. You will count <strong>k-mers</strong> (short sequences, e.g. 8 bases in length) in the sequences underneath the ChIP-seq peaks of a specific transcription factor, and analyze which k-mers are overrepresented.</p>
<p>DNA (or amino acid) sequence files are usually in FASTA format. Check out https://en.wikipedia.org/wiki/FASTA_format for a FASTA description and an example. Just read the first part.</p>
<p>Before you start off using the FASTA files from the study mentioned above, you will work on a file called “testfile.fasta” (present in <code class="docutils literal notranslate"><span class="pre">/scratch/cfb/list-dict-loop</span></code>), which is a small FASTA file. This allows you to make and test your code quicker.</p>
<ol class="simple">
<li><p>Provide the Python code that allows you to read the FASTA file while ignoring the description lines containing “&gt;”. For now it is OK to print the output.</p></li>
<li><p>Extend your code with the following: For each sequence, extract all possible k-mers of length 4. Skip sequences that are shorter than 4 bases. Print the output. Make sure your code allows you to easily run the same analysis with different k-mer lengths.</p></li>
<li><p>Extend your code with the following: Count the number of occurrences for each k-mer that is encountered (in all sequences together)</p></li>
<li><p>Extend your code with the following: Write the top 10 most abundant k-mer sequences to an output file, along the the number of times they occur</p></li>
<li><p>Now that you have assembled your code (you can remove the printing statements you used for testing) adapt your code to count kmers of <strong>length 8</strong>. Run your code on 2 files present in the <code class="docutils literal notranslate"><span class="pre">/scratch/cfb/list-dict-loop</span></code> directory:</p></li>
</ol>
<ul class="simple">
<li><p>GSM288346_ES_Oct4_mm9.peaks.fasta</p></li>
<li><p>GSM288356_ES_c-Myc_mm9.peaks.fasta</p></li>
<li><p>GSM288353_ES_Stat3_mm9.peaks.fasta</p></li>
<li><p>GSM288354_ES_Klf4_mm9.peaks.fasta</p></li>
</ul>
<p>For the top most occurring 8-mers that you obtained for each file, do these resemble the motifs for the corresponding transcription factors as displayed in Figure 2 of the paper?</p>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Simon van Heeringen, Arjen Brinkman, Kees Albers<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>